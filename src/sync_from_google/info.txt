Рабочий скрипт (win1251) по обновлению наличия товаров на складе, данные берем из гугл таблицы, 
кэшируем данные и проверяем на изменение наличия на складе, если товаров стало 0 или стало больше 0 записываем ID товара в массив, 
затем обновляем наличие, после этого удаляем кэш html-страниц у товаров которые попали в массив для обновления

класс для выполнения SQL-запросов  StockQuery содержит в себе методы GET и SET

$id = '1DDMulcd1VOjMaF9N_pCOfiQUqEs9HWbi96bdXDouOmM'; // Id документа
$gid = '1078493664'; // Id листа
$range = 'D325:H330'; // диапазон страниц

Функция для загрузки данных из Google Sheets 
fetchGoogleSheetData(string $id, string $gid, string $range)

Функция проверки даты кэша файла 
function checkingCacheDate(string $id, string $gid, string $range)

Функция обновление остатков 
function updateStock(array $data, string $brand_id, string $iblock_id, string $facet_id)

Функция определение товаров, у которых изменилась доступность
function processData(array $data, string $brand_id, string $iblock_id, string $facet_id)

Функция для очистки кэша элемента и категорий
function clearHtmlCacheByElementId($elementId, $iblockId)
